"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const commands_1 = require("../../commands");
const AnonymousCommand_1 = require("../../../base/AnonymousCommand");
const autocomplete_1 = require("../../../../autocomplete");
const vorpal = require('../../../../vorpal-init');
class CliCompletionPwshUpdateCommand extends AnonymousCommand_1.default {
    get name() {
        return commands_1.default.COMPLETION_PWSH_UPDATE;
    }
    get description() {
        return 'Updates command completion for PowerShell';
    }
    commandAction(cmd, args, cb) {
        if (this.debug) {
            cmd.log('Generating command completion...');
        }
        autocomplete_1.autocomplete.generateShCompletion(vorpal);
        if (this.debug) {
            cmd.log(vorpal.chalk.green('DONE'));
        }
        cb();
    }
    commandHelp(args, log) {
        log(vorpal.find(commands_1.default.COMPLETION_PWSH_UPDATE).helpInformation());
        log(`  Remarks:
  
    This commands updates the list of commands and their options used by
    command completion in PowerShell. You should run this command each time
    after upgrading the Office 365 CLI.
   
  Examples:
  
    Update list of commands for PowerShell command completion
      ${this.getCommandName()}

  More information:

    Command completion
      https://pnp.github.io/office365-cli/concepts/completion/
`);
    }
}
module.exports = new CliCompletionPwshUpdateCommand();
//# sourceMappingURL=completion-pwsh-update.js.map